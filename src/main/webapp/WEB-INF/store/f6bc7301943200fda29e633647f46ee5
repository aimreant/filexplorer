CREATE TABLE file(
  id INT UNIQUE AUTO_INCREMENT PRIMARY KEY ,
  hash VARCHAR(200) NOT NULL UNIQUE ,
  size BIGINT NOT NULL ,
  created_at DATETIME NOT NULL ,
  deleted_at DATETIME
);

CREATE TABLE directory(
  id INT UNIQUE AUTO_INCREMENT PRIMARY KEY ,
  name VARCHAR(50) NOT NULL ,
  parent_id INT ,
  user_id INT NOT NULL ,
  created_at DATETIME NOT NULL ,
  deleted_at DATETIME ,
  FOREIGN KEY (user_id) REFERENCES user(id) ,
  FOREIGN KEY (parent_id) REFERENCES directory(id)
);

CREATE TABLE level(
  id INT UNIQUE AUTO_INCREMENT PRIMARY KEY ,
  space_allow BIGINT
);

CREATE TABLE user(
  id INT UNIQUE AUTO_INCREMENT PRIMARY KEY ,
  username VARCHAR(20) UNIQUE NOT NULL ,
  password VARCHAR(100) NOT NULL ,
  level_id INT NOT NULL ,
  space_usage BIGINT NOT NULL ,
  created_at DATETIME NOT NULL ,
  deleted_at DATETIME ,
  FOREIGN KEY (level_id) REFERENCES level(id)
);

CREATE TABLE link(
  id INT UNIQUE AUTO_INCREMENT PRIMARY KEY ,
  filename VARCHAR(50) NOT NULL ,
  directory_id INT NOT NULL ,
  file_id INT NOT NULL ,
  user_id INT NOT NULL ,
  created_at DATETIME NOT NULL ,
  deleted_at DATETIME ,
  FOREIGN KEY (directory_id) REFERENCES directory(id),
  FOREIGN KEY (file_id) REFERENCES file(id),
  FOREIGN KEY (user_id) REFERENCES user(id)
);

CREATE TABLE admin(
  id INT UNIQUE AUTO_INCREMENT PRIMARY KEY ,
  username VARCHAR(20) UNIQUE NOT NULL ,
  password VARCHAR(100) NOT NULL ,
  created_at DATETIME NOT NULL ,
  deleted_at DATETIME
);

CREATE TABLE log(
  id INT UNIQUE AUTO_INCREMENT PRIMARY KEY ,
  operation VARCHAR(20) NOT NULL ,
  file_id INT NOT NULL ,
  user_id INT NOT NULL ,
  created_at DATETIME NOT NULL ,
  FOREIGN KEY (file_id) REFERENCES file(id) ,
  FOREIGN KEY (user_id) REFERENCES user(id)
);